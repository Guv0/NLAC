<!-- TITLE -->
<% content_for(:title_tag) do %>
  NLAC | <%= @business_card.user == current_user ? "My contacts" : @business_card.full_name + "'s contacts" %>
<% end %>

<div class="container">

  <!-- LEFT -->
  <div class="content-left">
    <h1>
      <strong>
        <%= @business_card.user.id == current_user.id ? "MY CONTACTS" : @business_card.first_name.upcase + "'S CONTACTS"  %> (<%= @business_card.user.contacts.count %>)
      </strong>
    </h1>

    <!-- SEARCH -->
    <div class="main-search">
      <%= form_tag business_card_connections_path(@business_card), method: :get do %>
        <%= text_field_tag :info, params[:info], placeholder: 'Search name, location, industry, company', class: "search-input" %>
        <%= text_field_tag :tag, params[:tag], placeholder: 'Search tags', class: "search-input" %>
        <%= button_tag(type: "submit", class: "search-btn") do %>
          <i class="material-icons">search</i>
        <% end %>
      <% end %>
    </div>

    <!-- CONTACTS -->
    <div class="index">
      <% @contacts.each do |contact| %>
        <div class="contact-card">
          <% if !contact.photo.url.nil? %>
            <% avatar = contact.photo.url %>
          <% elsif contact.linkedin_picture_url != "" %>
            <% avatar = contact.linkedin_picture_url %>
          <% else %>
            <% avatar = "avatar.png" %>
          <% end %>
          <!-- AVATAR -->
          <% if current_user.contacts.include?(contact.user) || current_user. business_card == contact %>
            <%= link_to business_card_path(contact) do %>
              <%= image_tag avatar, class: "contact-card-avatar" %>
            <% end %>
          <% else %>
            <%= image_tag avatar, class: "contact-card-avatar" %>
          <% end %>
          <!-- INFO -->
          <div class="contact-card-info">
            <% if current_user.contacts.include?(contact.user) || current_user. business_card == contact %>
              <%= link_to business_card_path(contact) do %>
                <h2 class="link-decoration"><%= contact.full_name %></h2>
              <% end %>
            <% else %>
              <h2><%= contact.full_name %></h2>
            <% end %>
            <div class="flex-start">
              <i class="material-icons">location_on</i>
              <h6><%= contact.location %></h6>
            </div>
            <div class="flex-start">
              <i class="material-icons">location_city</i>
              <h6><%= contact.industry %></h6>
            </div>
            <div class="flex-start">
              <i class="material-icons">business_center</i>
              <h6><%= contact.company_name %></h6>
            </div>
          </div>
          <div class="contact-card-right">
            <!-- MESSAGE -->
            <div class="contact-card-message">
              <% if current_user.contacts.include?(contact.user) %>
                <%= link_to do %>
                  <i class="material-icons">email</i>
                <% end %>
              <% end %>
            </div>
            <!-- TAGS -->
            <div class="contact-card-tags">
              <h3>TAGS</h3>
              <div class="contact-card-tags-display">
                <% contact.tags.valid_tags(contact.id, current_user.id).uniq.each do |tag| %>
                  <div class="tag-card-small">
                    <p><%= tag.label %></p>
                  </div>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <!-- RIGHT -->
  <div class="content-right">
    <!-- HOT TAGS -->
    <div class="content-right-container">
      <h3>
        <strong>
          Popular tags in <%= @business_card.user.id == current_user.id ? "my contacts" : @business_card.first_name.capitalize + "'s contacts"  %>
        </strong>
      </h3>
      <div class="content-right-card">
        <% @hot_tags.each_with_index do |array, index| %>
          <div class="hot-tag">
            <% if index + 1 == 1 %>
              <%= image_tag "first.png" %>
              <h5 style="margin-right: auto; color: #2AAF74;"><%= array[0] %></h5>
              <p>(<%= array[1] %>)</p>
            <% elsif index + 1 == 2 %>
              <%= image_tag "second.png" %>
              <h5 style="margin-right: auto; color: #2AAF74;"><%= array[0] %></h5>
              <p>(<%= array[1] %>)</p>
            <% elsif index + 1 == 3 %>
              <%= image_tag "third.png" %>
              <h5 style="margin-right: auto; color: #2AAF74;"><%= array[0] %></h5>
              <p>(<%= array[1] %>)</p>
            <% else %>
              <h5>#<%= index %></h5>
              <h5 style="margin-right: auto;"><%= array[0] %></h5>
              <p>(<%= array[1] %>)</p>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>

    <!-- RECENT UPDATES -->
    <div class="content-right-container">
      <h3>
        <strong>
          Recent updates in <%= @business_card.user.id == current_user.id ? "my contacts" : @business_card.first_name.capitalize + "'s contacts"  %>
        </strong>
      </h3>
      <div class="content-right-card">

      </div>
    </div>
  </div>

</div>


<!-- TO ADD -->
<%# link_to "Import contacts from Gmail", '/contacts/gmail' %>
